!function(t){"use strict";t.tppServerList=function(i,e){var a=t(i),o=t.extend(!0,t.tppServerList.defaults,e),l=function(){var i=a.find(o.pagSelector+" "+o.pagItemSelector);i.length&&i.each(function(){var i=t(this);i.on("click",function(t){t.preventDefault(),t.stopPropagation(),a.find(o.loadingSelector).show(),r(i)})})},r=function(i){var e=o.ajax;e.url=o.url,e.data.view=o.view,void 0!==i&&(e.data.limitstart=i.data("tpp-limitstart")),void 0!==t.fn.tpSerializeObject&&t.extend(e.data,a.find(o.filListSelector).tpSerializeObject()),o.formToken&&(e.data[o.formToken]=1),a.find(o.filterSelector).hide(),e.success=function(i){if(i&&i.data&&i.data.html){var e=a.find(o.listSelector);e.html(i.data.html),a.find(o.pagSelector).html(i.data.pagination),a.find(o.filterSelector).show(),e.find(".modal").on("show.bs.modal",function(){if(void 0!==t(this).attr("data-iframe")){var i=t(this).find(".modal-body"),a=t(t(this).attr("data-iframe"));i.find("iframe").remove(),i.prepend(a)}else{var l=e.find('.action-links [data-toggle=modal][href="#'+t(this).attr("id")+'"]').data("url");i=t(this).find(".modal-body");(a=t(o.iframeHtml)).attr("src",l),i.find("iframe").remove(),i.prepend(a)}}).on("shown.bs.modal",function(){if(void 0===t(this).attr("data-iframe")){var i=t(this),e=t(this).find("iframe"),a=(i.outerHeight(!0),i.find("div.modal-header:visible").outerHeight(!0)),o=i.find("div.modal-body:visible").outerHeight(!0),l=i.find("div.modal-body:visible").height(),r=i.find("div.modal-footer:visible").outerHeight(!0),d=i.position().top,n=o-l,s=t(window).height()-2*d-(a+r+n);e.height()>s&&(i.find(".modal-body").css({"max-height":s,"overflow-y":"initial"}),e.css("max-height",s-n))}}),l(),d(),a.find(o.loadingSelector).hide()}else a.find(o.errorSelector).show(),a.find(o.loadingSelector).hide(),a.find(o.filterSelector).show()},e.error=function(){a.find(o.filterSelector).hide(),a.find(o.loadingSelector).hide(),a.find(o.errorSelector).show()},t.ajax(e)};r();var d=function(){a.on("click",o.listSelector+" "+o.installSelector,function(i){i.preventDefault();var e=t(this),a=o.installNow,l=e.attr("href"),r=t(a.loadingHtml);if(!e.hasClass("installing")){e.html(r).addClass("installing");var d=a.ajax;d.url=o.url,d.data.pProduceUrl=l,d.data[o.formToken]=1,d.success=function(t){t.success&&e.addClass("disabled").html(a.installedHtml),t.data.redirect?location.href=t.data.redirect:location.href=o.url+"&view="+o.view+"&layout="+o.layout},t.ajax(d)}})};d()},t.tppServerList.defaults={url:"index.php?option=com_tz_portfolio_plus",view:"addon",layout:"upload",loading:"",iframeHtml:"",formToken:"",filterSelector:".js-stools",filListSelector:"[name^=list]",loadingSelector:"[data-tpp-loading]",errorSelector:"[data-tpp-error]",pagSelector:"[data-tpp-pagination]",pagItemSelector:"[data-tpp-limitstart]",listSelector:"[data-tpp-extension-list]",installSelector:".install-now",ajax:{type:"POST",dataType:"json",data:{format:"ajax",layout:"upload_list_item"}},installNow:{loadingHtml:"",installedHtml:"",ajax:{type:"POST",dataType:"json",data:{task:"addon.ajax_install"}}}},t.fn.tppServerList=function(i){if(void 0===i&&(i={}),"object"==typeof i)return this.each(function(){void 0===t(this).data("tppServerList")?new t.tppServerList(this,i):t(this).data("tppServerList")})}}(jQuery);